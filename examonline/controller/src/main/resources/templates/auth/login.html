<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>我的考试 - Exam Online</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i">
    <link rel="stylesheet" href="/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="/css/login.register.css">
</head>

<body>
    <div class="container">
        <a class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0" href="#">
            <div class="sidebar-brand-icon rotate-n-15"><i class="fas fa-laugh-wink"></i></div>
            <div class="sidebar-brand-text mx-3"><span>Exam Online</span></div>
        </a>
        <br><br>
        <div class="card">
            <div class="card-body">
                <form class="needs-validation" novalidate>
                    <div class="input-group mb-2">
                        <label for="username" class="col-sm-3 col-form-label"></span>用户名</span></label>
                        <div class="col-sm-9">
                            <input id="username" name="username" type="text" class="form-control" aria-label="username" required>
                            <div class="invalid-feedback">请输入用户名</div>
                          </div>
                    </div>

                    <div class="input-group mb-2">
                        <label for="passward" class="col-sm-3 col-form-label"></span>密码</span></label>
                        <div class="col-sm-9">
                            <input id="passward" name="password" type="password" class="form-control" aria-label="password" required>
                            <div class="invalid-feedback">请输入密码</div>
                          </div>
                    </div>
                    <div class="alert alert-danger mb-2" role="alert" id="err-msg" hidden></div>
                    <br>
                    <button type="button" class="btn btn-primary btn-lg mb-2 login" id="login">登录</button>
                    <p>还没有帐号？<a href="register.html">立即注册</a></p>
                </form> 
            </div>

        </div>
        
    </div>


    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.js"></script>
    <script src="/js/script.min.js"></script>

    <script type="text/javascript">
        $(function(){
            $('#login').click(function(){
                if($('#username').val() == '')
                {
                    alert('请输入用户名');
                    $('#username').focus();
                    return;
                }
                if($('#password').val() == '')
                {
                    alert('请输入登录密码');
                    $('#password').focus();
                    return ;
                }

                // 判断用户类型
                var usertype = null, url = null;
                if ($('#username').val()[0] == 'S') {
                    usertype = "student";
                    url = "student/login";
                } else if ($('#username').val()[0] == 'T') {
                    usertype = "teacher";
                    url = "teacher/login";
                } else if ($('#username').val()[0] == 'A') {
                    usertype = "admin";
                    url = "admin/login";
                } else {
                    alert('用户名错误！');
                    $('#username').focus();
                    return ;
                }

                var sendData={
                    "usertype": usertype,
                    "username": $('#username').val(),
                    "password": $('#password').val()
                };

                $.ajax({
                    type: "post",
                    url: "student/login",
                    data: sendData,
                    datatype: "json",
                    success: function(resultMsg){
                        if(msg.code == 0){
                            //登录成功
                            console.log(resultMsg.data.username);
                            SetCookie("userid", resultMsg.data.userid);
                            window.location.href="index.html";
                            //alert("欢迎:"+msg.data.username);
                        }else{
                            //登录失败
                            alert(resultMsg.msg);
                        }
                    },
                    error: function(resultMsg){
                        alert("通信失败");
                    }
                });
            })
        });

    </script>

</body>

</html>